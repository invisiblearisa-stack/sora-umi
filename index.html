<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="format-detection" content="telephone=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="ソラウミ">
  <meta name="theme-color" content="#1C6EF2">
  <title>ソラウミ</title>

  <style>
    :root { --fg:#0f1c28; --muted:#667; --line:#e5e7eb }
    *{ box-sizing:border-box }
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;
      margin:0; padding:16px; line-height:1.6; color:var(--fg); background:#fff;
    }
    header{ padding:6px 0 10px }
    h1{ margin:0; font-size:20px }
    .sub{ margin:0; color:var(--muted); font-size:14px }
    section{ margin:20px 0; padding-bottom:6px; border-bottom:1px dashed var(--line) }
    h2{ margin:8px 0 10px; font-size:26px }
    ul{ padding-left:20px; margin:8px 0 }
    .row{ display:flex; gap:8px; align-items:center; margin:8px 0; flex-wrap:wrap }
    input, select{ flex:1; min-width:120px; padding:10px; border:1px solid #ddd; border-radius:10px; }
    button{ padding:10px 14px; border-radius:10px; border:1px solid #cfd6dd; background:#fff; }
    li.touchable{ padding:6px 0 } li.touchable:active{ opacity:.6 }
    .inline-btn{ margin-left:8px }
    footer{ margin-top:20px; color:#8a8f98; font-size:12px }
  </style>

  <!-- ★ ホームアイコン自動生成（青背景＋白い「ソ」） -->
  <script>
  (function(){
    const S = 180; // アイコンサイズ
    const c = document.createElement('canvas');
    c.width = c.height = S;
    const g = c.getContext('2d');

    // 角丸の青い背景
    const r = 40;
    g.fillStyle = '#1e66ff';
    g.beginPath();
    g.moveTo(r,0); g.lineTo(S-r,0); g.quadraticCurveTo(S,0,S,r);
    g.lineTo(S,S-r); g.quadraticCurveTo(S,S,S-r,S);
    g.lineTo(r,S); g.quadraticCurveTo(0,S,0,S-r);
    g.lineTo(0,r); g.quadraticCurveTo(0,0,r,0); g.closePath();
    g.fill();

    // 白い「ソ」
    g.fillStyle = '#fff';
    g.font = 'bold 120px -apple-system, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif';
    g.textAlign = 'center';
    g.textBaseline = 'middle';
    g.fillText('ソ', S/2, S/2 + 6);

    // link要素を登録
    const link = document.createElement('link');
    link.rel = 'apple-touch-icon';
    link.sizes = '180x180';
    link.href = c.toDataURL('image/png');
    document.head.appendChild(link);
  })();
  </script>
</head>
<body>
  <header>
    <h1>ソラとウミ</h1>
    <p class="sub">就農→販売→配送までをガイド</p>
  </header>

  <!-- 1) ウミ：日々の作業 -->
  <section>
    <h2>今日のやること（ウミ）</h2>
    <ul id="tasks"></ul>
    <div class="row">
      <input id="newTask" placeholder="例：除草（30分）">
      <button id="addTask">追加</button>
    </div>
  </section>

  <!-- 2) ソラ：商品マスタ -->
  <section>
    <h2>販売（ソラ）</h2>
    <div class="row">
      <input id="pname"  placeholder="商品名（例：名久井米 2kg）">
      <input id="pprice" type="number" inputmode="numeric" placeholder="価格（円）">
      <input id="pstock" type="number" inputmode="numeric" placeholder="在庫(kg)">
      <button id="addProduct">商品作成</button>
    </div>
    <p id="msg"></p>
    <ul id="products"></ul>
  </section>

  <!-- 3) 受注・送り状 -->
  <section>
    <h2>受注・送り状</h2>
    <div class="row">
      <input id="cName"  placeholder="お届け先：氏名">
      <input id="cZip"   placeholder="郵便番号（例：031-0000）">
      <input id="cTel"   placeholder="電話番号">
      <input id="cAddr"  placeholder="住所（市区町村・番地・建物）">
    </div>
    <div class="row">
      <select id="cProduct"></select>
      <input id="cQty" type="number" inputmode="numeric" placeholder="数量" value="1">
      <button id="addOrder">注文追加</button>
    </div>
    <ul id="orders"></ul>
  </section>

  <footer><small>© ソラウミ</small></footer>

  <!-- ライブラリ -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="./app.js"></script>
</body>
</html>
